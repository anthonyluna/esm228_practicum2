---
title: "Practicum 2"
author: "AJ Zenkowski, Anthony Luna, Allison Hacker"
date: "5/1/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

```{r load, echo=FALSE}
# Load the required packages
library(DeclareDesign)
library(knitr)
library(ggplot2)
library(grid)
library(gridExtra)
library(dplyr)
library(kableExtra)
```


### Measurement 2: Strong coalitions between fishermen and suppliers 

**Target Population**: 1000 total fishing vessel captains and fish suppliers in the Monterey, Santa Cruz, and Half-Moon Bay Area. The population contains 700 fishers and 300 fish suppliers. Since suppliers are on land more often than fishers they tend to be more involved in coalition planning and meetings than fishers and therefore are more likely to percieve the coalitions that they are a part of as strong compared to fishers.

```{r pop}
## Declare Population
set.seed(228)
population <- declare_population(
  respondents = add_level(N=1000, 
     fisher=sample(c(rep(0,300),rep(1,700))),
     strong_coalition=correlate(given = fisher, rho = -0.5,
                         draw_binary, prob = 0.5)
))

pop <- population()

kable(table(pop$fisher,pop$strong_coalition)) %>% 
  add_header_above(c("fisher"=1,"strong coalition"=2))
```

```{r declare-report}
# Declare reporting probabilities
reporting <- declare_assignment(blocks=fisher,
                  assignment_variable = "R", 
                  block_prob=c(0.7,0.3)) #Block randomly assign respondents to the reporting category. Respondents who are not fishers (ie suppliers) are more likely to be "reporters" (R==1), meaning that they are more likely to be in port/market when enumerators try to administer the survey.
pop <- reporting(pop)

kable(table(pop$fisher,pop$strong_coalition)) %>% 
  add_header_above(c("fisher"=1,"strong_coalition"=2))
```


**Challenge of drawing a representative sample**: Fishing vessel captains are spend a lot of their time out at sea, so they are less available to respond to a survey than fish suppliers are. Additionally, there are more fishermen than fish suppliers. These factors make it difficult to draw a representative sample from the population.

```{r disp-sample}
# Constructing a disproportionate sample

sims <- 1000 #simulations
store <- rep(NA, sims)
fisher <- rep(NA, sims)
supplier <- rep(NA, sims)

fisher.index <- which(pop$fisher==1) #respondent IDs corresponding to fishers (fisher==1)
supplier.index <- which(pop$fisher==0) #respondent IDs corresponding to suppliers (fisher==0)
  
  sam <- c(sample(fisher.index,275),
           sample(supplier.index,75)) #constructing a sample that contains 75 suppliers and 275 fishers.
```

**Sampling procedure**: Stratified sampling at ports and fish markets with unequal effort according to differences in likelihood of reporting between fishers and suppliers.
```{r disp-strat}
# Disproportionate stratification 
for (i in 1:sims){
  sam <- c(sample(fisher.index,275),
           sample(supplier.index,75)) #drawn sample
  pop <- reporting(pop)
  fisher[i] <- mean(pop[sam,] %>%
               filter(R==1 & fisher==1) %>%
               pull(strong_coalition))
  supplier[i] <- mean(pop[sam,] %>%
               filter(R==1 & fisher==0) %>%
               pull(strong_coalition))
  store[i] <- fisher[i] * 0.7 + supplier[i] * 0.3
}
  
# Disproportionate histograms  
  fisher.hist2 <- ggplot(data.frame(fisher), aes(x=fisher)) + 
  geom_histogram(color="black", fill="white") +
  xlab("Mean value of strata sample") +
  geom_vline(xintercept = mean(pop$strong_coalition[pop$fisher==1]), linetype="dashed", color = "blue", size=1.5) +
  ggtitle("Fishers") + xlim(c(0,1))

supplier.hist2 <- ggplot(data.frame(supplier), aes(x=supplier)) + 
  geom_histogram(color="black", fill="white") +
  xlab("Mean value of strata sample") +
  geom_vline(xintercept = mean(pop$strong_coalition[pop$fisher==0]), linetype="dashed", color = "blue", size=1.5) +
  ggtitle("Suppliers") + xlim(c(0,1))

grid.arrange(fisher.hist2,supplier.hist2,ncol=2)
```

# Measurement 6: Improve traceability in the global seafood supply chain - Anthony

**Target Population**:

```{r pop_m6}
#Declare your population
```
```{r delare-report_m6}
#Declare Reporting Probabilities
```


**Challenge of drawing a representative sample**:
```{r disp-sample_m6}
#Constucting Disproportionate Sample
```


**Sampling procedure**: 
```{r display-strat_m6}
# Disproportionate stratification 
# Disproportionate histograms  
```



# Measurement 1: Increase awareness for sustainable seafood 

**Target Population**:

```{r pop_m1}
#Declare your population
```
```{r delare-report_m1}
#Declare Reporting Probabilities
```


**Challenge of drawing a representative sample**:
```{r disp-sample_m1}
#Constucting Disproportionate Sample
```


**Sampling procedure**: 
```{r display-strat_m1}
# Disproportionate stratification 
# Disproportionate histograms  
```

